# AutoStockSheet

This project is designed to track data on stock prices, PER (Price-to-Earnings Ratio), and EPS (Earnings Per Share), and store them into Google Sheets using Google Cloud Functions (GCF), Google Cloud Storage (GCS), and Pub/Sub in Google Cloud Platform (GCP).

## References

This project is inspired by and utilizes information and resources from the following references:

- [Google Cloud Functions Documentation](https://cloud.google.com/functions/docs)
- [Google Sheets API Documentation](https://developers.google.com/sheets/api)
- [Pub/Sub Documentation](https://cloud.google.com/pubsub/docs)
- [gspread Library](https://docs.gspread.org/en/v6.0.0/)  
- [yfinance Library](https://github.com/ranaroussi/yfinance)  

## Introduction

AutoStockSheet automates the process of tracking and storing stock-related data into Google Sheets. It leverages GCP services for cloud-based data management and processing.

## Features

- Track stock prices, PER, and EPS
- Store data in Google Sheets automatically
- Utilize GCF, GCS, and Pub/Sub for efficient data handling

## Installation and Usage on GCP

Follow these steps to set up and use the project:

1. **Set up Google Cloud Platform (GCP)**
    - Create a GCP project and enable the necessary APIs (Google Sheets API, Cloud Functions, Cloud Storage, Pub/Sub).
    - Set up authentication, download the service account key, and get the JSON file of the service account.

2. **Create a Google Sheet**
    - Share the sheet with the service account that you created on GCP.

3. **Configure the Code**
    - Modify `dict_gid` in the `DataManager` class to match your Google Sheets: `{'Name of Sheet': 'ID of sheet'}` (line 9).
    - The ID of the sheet is the last part of the URL of the Google Sheet.
    - Update `lst_stocks` in `main.py` (line 37) with the stocks you want to track.

4. **Deploy to Google Cloud Functions**
    - Upload all files, including `service_account_key.json`, to the source section of your Cloud Function.

5. **Set Up Cloud Scheduler**
    - Connect Cloud Function with Pub/Sub and Pub/Sub with Scheduler to automate the execution.

## Run locally (optional)
1. **Clone the repository**
    ```bash
    git clone https://github.com/hei8san/AutoStockSheet.git
    cd AutoStockSheet
    ```
2. **Create a Google Sheet**
    - Share the sheet with the service account that you created on GCP.

3. **Configure the Code**
    - Modify `dict_gid` in the `DataManager` class to match your Google Sheets: `{'Name of Sheet': 'ID of sheet'}` (line 9).
    - The ID of the sheet is the last part of the URL of the Google Sheet.
    - Update `lst_stocks` in `main.py` (line 37) with the stocks you want to track.

4. **Install the required dependencies**
    ```bash
    pip install -r requirements.txt
    ```
5. **Run the Main Script**
    ```bash
    python main.py
    ```

## Project Structure

```plaintext
AutoStockSheet/
├── data_management.py      # Handles data fetching and processing
├── main.py                 # Main script to run the project
├── requirements.txt        # Project dependencies
├── README.md               # Project README
└── credential_key.json     # JSON file generated by service account
```
